(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t){},107:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(53),i=a.n(c),o=(a(65),a(3)),u=a(6),l=a(8),s=a(7),d=a(9),m=a(112),f=a(108),b=a(110),h=a(111),p=a(37),w=a.n(p),k=a(4),v=a(12),g=a(56),O=a.n(g),j=a(27),_=a.n(j),y=function(e){var t=e.url,a=e.color,n=e.state,c=e.clicked,i=[_.a.square,_.a["square-".concat(a)]];return n&&i.push(_.a["square-".concat(n)]),r.a.createElement("div",{className:i.join(" "),style:{backgroundImage:t},onClick:c})},E=function(e){var t=q(e),a=Object(k.a)(t,2),n=a[0],r=a[1];return"".concat(String.fromCharCode(97+r)).concat(8-n)},M=function(e){var t=Object(k.a)(e,2);return 8*t[0]+t[1]},q=function(e){return[Math.floor(e/8),e%8]},I=Object(v.b)(function(e){return{state:e}},function(e){return{clickHandler:function(t,a){if(null!==t.selectedSquare){if(t.selectedSquare===a)e({type:"DESELECT"});else if(t.allowedMoves.includes(a)){var n={type:"MOVE",from:t.selectedSquare,to:a};t.socket.emit("makeMove",{action:n,roomId:t.gameId})}}else(function(e,t){return("white"===e.player?e.whiteMove:!e.whiteMove)&&e.board[t]&&e.board[t].player===e.player})(t,a)&&e({type:"SELECT",id:a})}}})(function(e){var t=e.state,a=e.clickHandler;return r.a.createElement("div",{className:O.a["board-container"]},t.board.map(function(e,n){var c=q(n),i=Object(k.a)(c,2),o=i[0],u=i[1],l=t.selectedSquare===n?"selected":t.allowedMoves.includes(n)?"allowed":t.checkedSquare===n?"checked":null;return r.a.createElement(y,{key:E(n),url:e?"url(".concat(e.image,")"):"none",color:(o+u)%2===0?"light":"dark",state:l,clicked:function(){return a(t,n)}})}))}),C=a(14),x=a(13),G=a(18),S=a.n(G),N=Object(v.b)(function(e){return{taken:e.taken}})(function(e){var t=e.player,a=e.taken,n=[S.a.taken,S.a["taken-".concat(t)]],c=a[t].length?a[t].reduce(function(e,t){return e.hasOwnProperty(t.name)?Object(x.a)({},e,Object(C.a)({},t.name,[t.image,++e[t.name][1]])):Object(x.a)({},e,Object(C.a)({},t.name,[t.image,1]))},{}):{},i=Object.values(c)?Object.values(c).map(function(e,t){var a=Object(k.a)(e,2),n=a[0],c=a[1];return r.a.createElement("div",{key:t,className:S.a.figure,style:{backgroundImage:"url(".concat(n,")")}},c>1?r.a.createElement("div",{className:S.a.number},c):null)}):null;return r.a.createElement("div",{className:n.join(" ")},i)}),P=a(28),T=a.n(P),A=Object(v.b)(function(e){return{player:e.whiteMove?"white":"black"}})(function(e){var t=e.player,a=[T.a["current-square"],T.a["current-".concat(t)]];return r.a.createElement("div",{className:T.a["current-container"]},"Move: ",r.a.createElement("div",{className:a.join(" ")}))}),B=function(){return window.onbeforeunload=function(){return window.confirm("Do you really want to leave? Game will be lost")},r.a.createElement("div",{className:w.a.game},r.a.createElement("div",{className:w.a.field},r.a.createElement(N,{player:"black"}),r.a.createElement(I,null),r.a.createElement(N,{player:"white"})),r.a.createElement(A,null))},L=a(29),D=a.n(L),K=a(39),W=a.n(K),F=function(e){var t=e.isActive,a=e.clicked,n=e.children,c=[W.a["tab-item"]];return t&&c.push(W.a["tab-active"]),r.a.createElement("div",{className:c.join(" "),onClick:a},n)},H=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={selectedTab:"new"},a.newGame=function(){var e=document.getElementById("name").value;a.props.socket.emit("createGame",{name:e})},a.joinGame=function(){var e=document.getElementById("name").value,t=document.getElementById("gameId").value;a.props.socket.emit("joinGame",{name:e,roomId:t})},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){var e=document.getElementById("idInput");e&&e.select()}},{key:"selectTab",value:function(e){this.setState({selectedTab:e})}},{key:"copyId",value:function(){document.getElementById("idInput").select(),document.execCommand("copy")}},{key:"render",value:function(){var e=this,t=r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Enter your name:"),r.a.createElement("input",{type:"text",id:"name",placeholder:"Name"}),"new"===this.state.selectedTab?r.a.createElement("button",{onClick:this.newGame},"Create game"):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Enter game ID:"),r.a.createElement("input",{type:"text",name:"id",id:"gameId",placeholder:"Game ID"}),r.a.createElement("button",{onClick:this.joinGame},"Join game"))),a=r.a.createElement(r.a.Fragment,null,r.a.createElement(F,{clicked:function(){return e.selectTab("new")},isActive:"new"===this.state.selectedTab},"New game"),r.a.createElement(F,{clicked:function(){return e.selectTab("join")},isActive:"join"===this.state.selectedTab},"Join game"),r.a.createElement("div",{className:D.a["tab-content"]},t));return r.a.createElement("div",{className:D.a.container},this.props.gameId?r.a.createElement("div",{className:D.a["waiting-container"]},r.a.createElement("p",null,"Waiting for opponent..."),r.a.createElement("p",null,"Game ID: ",r.a.createElement("input",{id:"idInput",readOnly:!0,value:this.props.gameId}),r.a.createElement("i",{onClick:this.copyId,className:"fas fa-copy"})),r.a.createElement("p",null,"Share this ID with your friend, so they can join.")):a)}}]),t}(n.Component),J=Object(v.b)(function(e){return{socket:e.socket,gameId:e.gameId}})(H),V=a(2),X=function(e,t){return null!==t?e[t].getMoves(e,t).filter(function(a){return!e[a]||e[a].player!==e[t].player}):[]},Y=function e(t,a,n){Object(o.a)(this,e),this.player=t,this.image=a,this.name=n,this.firstMove=!0},z=function(e){return function(){return e.apply(void 0,arguments).filter(R).map(M)}},R=function(e){return e[0]>=0&&e[0]<=7&&e[1]>=0&&e[1]<=7},Q={row:z(function(e){return[[e,0],[e,1],[e,2],[e,3],[e,4],[e,5],[e,6],[e,7]]}),column:z(function(e){return[[0,e],[1,e],[2,e],[3,e],[4,e],[5,e],[6,e],[7,e]]}),diagonalX:z(function(e){return[[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6],[7,7]].map(function(t){return[t[0]+e,t[1]]})}),diagonalY:z(function(e){return[[0,7],[1,6],[2,5],[3,4],[4,3],[5,2],[6,1],[7,0]].map(function(t){return[t[0]+e,t[1]]})}),shapeL:z(function(e,t){return[[e-2,t-1],[e-2,t+1],[e-1,t-2],[e-1,t+2],[e+1,t-2],[e+1,t+2],[e+2,t-1],[e+2,t+1]]}),around:z(function(e,t){return[[e-1,t-1],[e-1,t],[e-1,t+1],[e,t-1],[e,t+1],[e+1,t-1],[e+1,t],[e+1,t+1]]}),forward:z(function(e,t,a){return[[e+a,t],[e+2*a,t]]}),sides:z(function(e,t,a){return[[e+a,t+1],[e+a,t-1]]})},U=function(e,t,a){var n=e.slice(0,e.indexOf(a)).filter(function(e){return e!==a}).map(function(e){return t[e]?1:0}).lastIndexOf(1),r=e.slice(e.indexOf(a)+1).map(function(e){return t[e]?1:0}).indexOf(1);return e.slice(-1===n?0:n,-1===r?e.length+1:e.indexOf(a)+r+2)},$=function(e){function t(e){Object(o.a)(this,t);var a="white"===e?"https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt45.svg":"https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt45.svg";return Object(l.a)(this,Object(s.a)(t).call(this,e,a,"Queen"))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getMoves",value:function(e,t){var a=q(t),n=Object(k.a)(a,2),r=n[0],c=n[1],i=U(Q.row(r),e,t),o=U(Q.column(c),e,t),u=U(Q.diagonalX(r-c),e,t),l=U(Q.diagonalY(r+c-7),e,t);return Object(V.a)(i).concat(Object(V.a)(o),Object(V.a)(u),Object(V.a)(l))}}]),t}(Y),Z=function(e,t){var a=e.whiteMove?"white":"black",n=Object(V.a)(e.board);return n[t.from]=null,n[t.to]="Pawn"===e.board[t.from].name&&(t.to<=7||t.to>=56)?new $(a):e.board[t.from],"King"===e.board[t.from].name&&t.from-t.to===2?(n[t.from-4]=null,n[t.from-1]=e.board[t.from-4]):"King"===e.board[t.from].name&&t.from-t.to===-2&&(n[t.from+3]=null,n[t.from+1]=e.board[t.from+3]),n},ee=function(e,t){return e.map(function(e,t){return{figure:e,index:t}}).filter(function(e){return e.figure&&e.figure.player===("white"===t.figure.player?"black":"white")}).reduce(function(t,a){return Object(V.a)(t).concat(Object(V.a)(X(e,a.index)))},[]).includes(t.index)},te=function(e,t){return e.map(function(e,t){return{figure:e,index:t}}).filter(function(e){return e.figure&&e.figure.player===t&&"King"===e.figure.name})[0]},ae=function(e,t){return X(e.board,t).filter(function(a){var n=Z(e,{from:t,to:a}),r=te(n,n[a].player);return!ee(n,r)})},ne=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(s.a)(t).call(this,e))).startGame=function(){a.props.history.push("/".concat(a.props.gameId))},a.endGame=function(){alert("Opponent has left the game"),a.props.clearGame()},e.socket.on("gameCreated",function(t){var a=t.roomId;e.setGame(a,"white")}),e.socket.on("gameJoined",function(t){var a=t.roomId;e.setGame(a,"black")}),e.socket.on("startGame",function(){a.startGame()}),e.socket.on("endGame",function(){a.endGame()}),e.socket.on("moveMade",function(e){a.handleMove(e)}),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"handleMove",value:function(e){this.props.moveHandler(e),function(e){var t=e.whiteMove?"white":"black",a=te(e.board,t),n=0===e.board.map(function(e,t){return{figure:e,index:t}}).filter(function(e){return e.figure&&e.figure.player===t}).reduce(function(t,a){return Object(V.a)(t).concat(Object(V.a)(ae(e,a.index)))},[]).length?ee(e.board,a)?"Checkmate! ".concat(e.whiteMove?"Black":"White"," wins!"):"Stalemate!":null;n&&alert(n)}(this.props.state)}},{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(f.a,{exact:!0,path:"/",component:J}),this.props.gameId?r.a.createElement(f.a,{path:"/".concat(this.props.gameId),component:B}):null,r.a.createElement(b.a,{to:"/"}))}}]),t}(n.Component),re=Object(h.a)(Object(v.b)(function(e){return{state:e,socket:e.socket,gameId:e.gameId}},function(e){return{moveHandler:function(t){return e(t)},setGame:function(t,a){return e({type:"SET_GAME",gameId:t,player:a})},clearGame:function(){return e({type:"CLEAR_GAME"})}}})(ne));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ce=a(109),ie=a(23),oe=a(58),ue=a.n(oe),le=function(e){function t(e){Object(o.a)(this,t);var a="white"===e?"https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt45.svg":"https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt45.svg";return Object(l.a)(this,Object(s.a)(t).call(this,e,a,"Bishop"))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getMoves",value:function(e,t){var a=q(t),n=Object(k.a)(a,2),r=n[0],c=n[1],i=U(Q.diagonalX(r-c),e,t),o=U(Q.diagonalY(r+c-7),e,t);return Object(V.a)(i).concat(Object(V.a)(o))}}]),t}(Y),se=function(e){function t(e){Object(o.a)(this,t);var a="white"===e?"https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt45.svg":"https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt45.svg";return Object(l.a)(this,Object(s.a)(t).call(this,e,a,"King"))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getMoves",value:function(e,t){var a=q(t),n=Object(k.a)(a,2),r=n[0],c=n[1],i=Q.around(r,c),o=this.firstMove&&e[t+3]&&e[t+3].firstMove&&!e[t+1]&&!e[t+2]?[8*r+6]:[],u=this.firstMove&&e[t-4]&&e[t-4].firstMove&&!e[t-1]&&!e[t-2]&&!e[t-3]?[8*r+2]:[];return Object(V.a)(i).concat(o,u)}}]),t}(Y),de=function(e){function t(e){Object(o.a)(this,t);var a="white"===e?"https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt45.svg":"https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt45.svg";return Object(l.a)(this,Object(s.a)(t).call(this,e,a,"Knight"))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getMoves",value:function(e,t){return Q.shapeL.apply(Q,Object(V.a)(q(t)))}}]),t}(Y),me=function(e){function t(e){Object(o.a)(this,t);var a="white"===e?"https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt45.svg":"https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt45.svg";return Object(l.a)(this,Object(s.a)(t).call(this,e,a,"Pawn"))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getMoves",value:function(e,t){var a=q(t),n=Object(k.a)(a,2),r=n[0],c=n[1],i="black"===this.player?1:-1,o=Q.sides(r,c,i).filter(function(t){return e[t]}),u=Q.forward(r,c,i),l=Object(k.a)(u,2),s=l[0],d=l[1],m=e[s]?[]:this.firstMove&&!e[d]?[s,d]:[s];return Object(V.a)(o).concat(m)}}]),t}(Y),fe=function(e){function t(e){Object(o.a)(this,t);var a="white"===e?"https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt45.svg":"https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt45.svg";return Object(l.a)(this,Object(s.a)(t).call(this,e,a,"Rook"))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getMoves",value:function(e,t){var a=q(t),n=Object(k.a)(a,2),r=n[0],c=n[1],i=U(Q.row(r),e,t),o=U(Q.column(c),e,t);return Object(V.a)(i).concat(Object(V.a)(o))}}]),t}(Y),be={gameId:null,player:null,socket:ue()("https://reactive-chess.herokuapp.com/"),board:function(){var e={a1:new fe("white"),b1:new de("white"),c1:new le("white"),d1:new $("white"),e1:new se("white"),f1:new le("white"),g1:new de("white"),h1:new fe("white"),a2:new me("white"),b2:new me("white"),c2:new me("white"),d2:new me("white"),e2:new me("white"),f2:new me("white"),g2:new me("white"),h2:new me("white"),a7:new me("black"),b7:new me("black"),c7:new me("black"),d7:new me("black"),e7:new me("black"),f7:new me("black"),g7:new me("black"),h7:new me("black"),a8:new fe("black"),b8:new de("black"),c8:new le("black"),d8:new $("black"),e8:new se("black"),f8:new le("black"),g8:new de("black"),h8:new fe("black")};return Array(64).fill(null).map(function(t,a){var n=E(a);return e.hasOwnProperty(n)?e[n]:t})}(),taken:{black:[],white:[]},whiteMove:!0,selectedSquare:null,checkedSquare:null,allowedMoves:[]},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GAME":return Object(x.a)({},e,{gameId:t.gameId,player:t.player});case"CLEAR_GAME":return be;case"SELECT":return Object(x.a)({},e,{selectedSquare:t.id,allowedMoves:ae(e,t.id)});case"DESELECT":return Object(x.a)({},e,{selectedSquare:null,allowedMoves:[]});case"MOVE":e.board[t.from].firstMove=!1;var a=e.whiteMove?"white":"black",n=Z(e,t),r=e.board[t.to]?Object(x.a)({},e.taken,Object(C.a)({},a,Object(V.a)(e.taken[a]).concat([e.board[t.to]]))):e.taken,c="white"===a?"black":"white",i=te(e.board,c);return Object(x.a)({},e,{board:n,taken:r,whiteMove:!e.whiteMove,selectedSquare:null,allowedMoves:[],checkedSquare:ee(n,i)?i.index:null});default:return e}},pe=Object(ie.b)(he),we=r.a.createElement(v.a,{store:pe},r.a.createElement(ce.a,null,r.a.createElement(re,null)));i.a.render(we,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},18:function(e,t,a){e.exports={taken:"takenPieces_taken__EaYaT","taken-white":"takenPieces_taken-white__3YiLr","taken-black":"takenPieces_taken-black__2e9ox",figure:"takenPieces_figure__13VlE",number:"takenPieces_number__knijx"}},27:function(e,t,a){e.exports={square:"square_square__3aaD-","square-light":"square_square-light__2Byps","square-dark":"square_square-dark__1oFKM","square-selected":"square_square-selected__15z7V","square-checked":"square_square-checked__1-Vqq","square-allowed":"square_square-allowed__bXO7e"}},28:function(e,t,a){e.exports={"current-container":"currentPlayer_current-container__hfQzT","current-square":"currentPlayer_current-square__72FGf","current-black":"currentPlayer_current-black__1rcxs","current-white":"currentPlayer_current-white__u0UHW"}},29:function(e,t,a){e.exports={container:"landingPage_container__313xh","waiting-container":"landingPage_waiting-container__2CX5a","tab-content":"landingPage_tab-content___wWL0"}},37:function(e,t,a){e.exports={game:"game_game__3lnfE",field:"game_field__2eiKM"}},39:function(e,t,a){e.exports={"tab-item":"tab_tab-item__3S6SW","tab-active":"tab_tab-active__b0Oz9"}},56:function(e,t,a){e.exports={"board-container":"board_board-container__3zE84"}},60:function(e,t,a){e.exports=a(107)},65:function(e,t,a){}},[[60,2,1]]]);
//# sourceMappingURL=main.2fd30cc3.chunk.js.map